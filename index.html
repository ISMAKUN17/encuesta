<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VIP Satisfaction Survey</title>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-database.js"></script>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .section { margin-bottom: 20px; }
        label { display: block; margin: 5px 0; }
    </style>
</head>
<body>
    <h2>VIP Satisfaction Survey</h2>
    <form id="surveyForm">
        <div class="section">
            <h3>Facilities</h3>
            <label>How would you rate the VIP LOUNGE services?</label>
            <select name="vipLoungeService">
                <option>Very good</option>
                <option>Good</option>
                <option>Poor</option>
                <option>Very poor</option>
            </select>
            
            <label>How do you consider the cleaning of the VIP LOUNGE?</label>
            <select name="vipLoungeCleaning">
                <option>Very good</option>
                <option>Good</option>
                <option>Poor</option>
                <option>Very poor</option>
            </select>
            
            <label>How do you consider the maintenance of the VIP LOUNGE?</label>
            <select name="vipLoungeMaintenance">
                <option>Very good</option>
                <option>Good</option>
                <option>Poor</option>
                <option>Very poor</option>
            </select>
            
            <label>How would you rate the food and beverages quality in the VIP LOUNGE?</label>
            <select name="vipLoungeFoodQuality">
                <option>Very good</option>
                <option>Good</option>
                <option>Poor</option>
                <option>Very poor</option>
            </select>
            
            <label>How would you rate the cleaning in your room?</label>
            <select name="roomCleaning">
                <option>Very good</option>
                <option>Good</option>
                <option>Poor</option>
                <option>Very poor</option>
            </select>
            
            <label>Did you receive the night coverage service?</label>
            <select name="nightCoverage">
                <option>Yes</option>
                <option>No</option>
            </select>
            
            <label>How do you consider the turndown?</label>
            <select name="turndown">
                <option>Very good</option>
                <option>Good</option>
                <option>Poor</option>
                <option>Very poor</option>
            </select>
        </div>
        
        <div class="section">
            <h3>Concierge VIP</h3>
            <label>How was the attention during your check-in/out process?</label>
            <select name="checkinCheckout">
                <option>Very good</option>
                <option>Good</option>
                <option>Poor</option>
                <option>Very poor</option>
            </select>
            
            <label>Did the concierge provide you with the information you required?</label>
            <select name="conciergeInfo">
                <option>Very good</option>
                <option>Good</option>
                <option>Poor</option>
                <option>Very poor</option>
            </select>
        </div>
        
        <div class="section">
            <h3>Butler Service</h3>
            <label>How do you consider the butler's attitude?</label>
            <select name="butlerAttitude">
                <option>Very good</option>
                <option>Good</option>
                <option>Poor</option>
                <option>Very poor</option>
            </select>
            
            <label>Did the butler offer help and support given to your needs?</label>
            <select name="butlerHelp">
                <option>Very good</option>
                <option>Good</option>
                <option>Poor</option>
                <option>Very poor</option>
            </select>
            
            <label>Did the butler handle your requirements promptly?</label>
            <select name="butlerPromptness">
                <option>Very good</option>
                <option>Good</option>
                <option>Poor</option>
                <option>Very poor</option>
            </select>
            
            <label>Did the butler offer suggestions to improve your Live Aqua experience?</label>
            <select name="butlerSuggestions">
                <option>Very good</option>
                <option>Good</option>
                <option>Poor</option>
                <option>Very poor</option>
            </select>
        </div>
        
        <div class="section">
            <label>Share your comments with us:</label>
            <textarea name="comments" rows="4" cols="50"></textarea>
        </div>
        
        <button type="submit">Submit</button>
    </form>

    <script>
        const firebaseConfig = {
            apiKey: "YOUR_API_KEY",
            authDomain: "YOUR_AUTH_DOMAIN",
            databaseURL: "YOUR_DATABASE_URL",
            projectId: "YOUR_PROJECT_ID",
            storageBucket: "YOUR_STORAGE_BUCKET",
            messagingSenderId: "YOUR_MESSAGING_SENDER_ID",
            appId: "YOUR_APP_ID"
        };
        
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();
        
        document.getElementById('surveyForm').addEventListener('submit', function(event) {
            event.preventDefault();
            const formData = new FormData(event.target);
            let surveyData = {};
            formData.forEach((value, key) => surveyData[key] = value);
            
            db.ref('surveys').push(surveyData).then(() => {
                alert('Survey submitted successfully!');
                event.target.reset();
            }).catch(error => console.error(error));
        });
    </script>
</body>
</html>
<html><head><base href="https://restaurant-reservations-app.com/" />
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Reservas VIP'S Secrets</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&family=Playfair+Display:wght@700&display=swap" rel="stylesheet">
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
<style>
  :root {
    --primary-color: #3a6ea5;
    --secondary-color: #c0d6df;
    --accent-color: #ff6b6b;
    --background-color: #f6f6f6;
    --text-color: #333;
  }

  body {
    font-family: 'Poppins', sans-serif;
    margin: 0;
    padding: 0;
    background-color: var(--background-color);
    color: var(--text-color);
    line-height: 1.6;
    font-size: 14px;
  }

  h1 {
    font-family: 'Playfair Display', serif;
    color: var(--primary-color);
    text-align: center;
    margin-bottom: 20px;
    font-size: 2.2em;
    letter-spacing: 1px;
  }

  .container {
    max-width: 900px;
    min-width: 320px;
    margin: 0 auto;
    padding: 15px;
  }

  form {
    background-color: #fff;
    padding: 15px;
    border-radius: 12px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 10px;
    max-width: 700px;
    width: 100%;
    margin: 0 auto;
  }

  .form-group {
    margin-bottom: 10px;
  }

  label {
    display: block;
    margin-bottom: 4px;
    font-weight: 600;
    color: var(--primary-color);
    font-size: 0.85em;
  }

  input, select, textarea {
    width: 100%;
    padding: 6px;
    border: 2px solid var(--secondary-color);
    border-radius: 8px;
    box-sizing: border-box;
    font-family: 'Poppins', sans-serif;
    font-size: 0.9em;
    transition: all 0.3s ease;
  }

  input:focus, select:focus, textarea:focus {
    outline: none;
    border-color: var(--primary-color);
    box-shadow: 0 0 0 3px rgba(58, 110, 165, 0.2);
  }

  button {
    grid-column: 1 / -1;
    background-color: var(--primary-color);
    color: #fff;
    border: none;
    padding: 8px 12px;
    border-radius: 8px;
    cursor: pointer;
    font-size: 0.9em;
    font-weight: 600;
    transition: all 0.3s ease;
    text-transform: uppercase;
    letter-spacing: 1px;
  }

  button:hover {
    background-color: #2c5282;
    transform: translateY(-2px);
    box-shadow: 0 4px 6px rgba(0,0,0,0.1);
  }

  .modal {
    display: none;
    position: fixed;
    z-index: 1;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    overflow: auto;
    background-color: rgba(0,0,0,0.5);
    opacity: 0;
    transition: opacity 0.3s ease;
  }

  .modal-content {
    background-color: #fefefe;
    margin: 10% auto;
    padding: 30px;
    border: 1px solid #888;
    width: 80%;
    max-width: 600px;
    border-radius: 12px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.3);
    transform: scale(0.7);
    transition: all 0.3s ease;
  }

  .modal.show {
    opacity: 1;
  }

  .modal.show .modal-content {
    transform: scale(1);
  }

  .close {
    color: #aaa;
    float: right;
    font-size: 28px;
    font-weight: bold;
    transition: color 0.3s ease;
  }

  .close:hover,
  .close:focus {
    color: #000;
    text-decoration: none;
    cursor: pointer;
  }

  .dress-code {
    margin-top: 20px;
    padding: 15px;
    background-color: var(--secondary-color);
    border-radius: 8px;
    font-size: 14px;
  }

  .dress-code h3 {
    margin-top: 0;
    color: var(--primary-color);
  }

  .error-message {
    color: var(--accent-color);
    font-weight: bold;
    text-align: center;
    font-size: 1.2em;
  }

  #reservationDisplay {
    margin-top: 40px;
  }

  .reservation-section {
    background-color: #fff;
    border-radius: 12px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    margin-bottom: 20px;
    padding: 15px;
  }

  .reservation-section h3 {
    color: var(--primary-color);
    margin-top: 0;
    font-size: 1.2em;
  }

  .reservation-section table {
    width: 100%;
    border-collapse: collapse;
  }

  .reservation-section th, .reservation-section td {
    padding: 8px;
    text-align: left;
    border-bottom: 1px solid var(--secondary-color);
    font-size: 0.9em;
  }

  .reservation-section th {
    font-weight: 600;
    color: var(--primary-color);
  }

  .total-pax {
    font-weight: 600;
    color: var(--primary-color);
    text-align: right;
    margin-top: 10px;
  }

  @keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
  }

  @keyframes slideIn {
    from { transform: translateY(20px); opacity: 0; }
    to { transform: translateY(0); opacity: 1; }
  }

  .form-group {
    animation: slideIn 0.5s ease forwards;
    opacity: 0;
  }

  .form-group:nth-child(1) { animation-delay: 0.1s; }
  .form-group:nth-child(2) { animation-delay: 0.2s; }
  .form-group:nth-child(3) { animation-delay: 0.3s; }
  .form-group:nth-child(4) { animation-delay: 0.4s; }
  .form-group:nth-child(5) { animation-delay: 0.5s; }
  .form-group:nth-child(6) { animation-delay: 0.6s; }

  .form-group:nth-child(7) {
    grid-column: 1 / -1;
  }

  @media (max-width: 768px) {
    body {
      font-size: 12px;
    }

    h1 {
      font-size: 1.8em;
    }

    .container {
      padding: 15px;
    }

    form {
      padding: 20px;
    }

    input, select, textarea, button {
      font-size: 0.9em;
    }

    .reservation-section {
      padding: 10px;
    }

    .reservation-section th, .reservation-section td {
      padding: 5px;
      font-size: 0.9em;
    }
  }

  @media (min-width: 768px) {
    body {
      font-size: 14px;
    }

    .container {
      padding: 15px;
    }

    form {
      padding: 15px;
    }

    input, select, textarea, button {
      font-size: 0.9em;
    }
  }

  @media (min-width: 1200px) {
    body {
      font-size: 16px;
    }

    h1 {
      font-size: 2.5em;
    }

    .container {
      max-width: 1000px;
    }

    input, select, textarea, button {
      font-size: 1em;
    }
  }

  @media (min-width: 1600px) {
    body {
      font-size: 18px;
    }

    h1 {
      font-size: 2.8em;
    }

    .container {
      max-width: 1100px;
    }

    input, select, textarea, button {
      font-size: 1.1em;
    }
  }

  .corner-buttons {
    position: fixed;
    top: 20px;
    right: 20px;
    display: flex;
    flex-direction: column;
    gap: 10px;
    z-index: 1000;
  }

  .corner-button {
    background-color: var(--primary-color);
    color: white;
    border: none;
    border-radius: 50%;
    width: 50px;
    height: 50px;
    display: flex;
    justify-content: center;
    align-items: center;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 0 2px 5px rgba(0,0,0,0.2);
  }

  .corner-button:hover {
    background-color: #2c5282;
    transform: translateY(-2px);
    box-shadow: 0 4px 8px rgba(0,0,0,0.2);
  }

  .corner-button svg {
    width: 24px;
    height: 24px;
  }

  #configModal, #reportModal {
    display: none;
    position: fixed;
    z-index: 1001;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    overflow: auto;
    background-color: rgba(0,0,0,0.5);
    opacity: 0;
    transition: opacity 0.3s ease;
  }

  #configModal.show, #reportModal.show {
    opacity: 1;
  }

  .config-section {
    margin-bottom: 20px;
  }

  .grid-layout {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 10px;
  }

  .button-group {
    display: flex;
    justify-content: flex-end;
    gap: 10px;
    margin-top: 20px;
  }

  .primary-button, .secondary-button {
    padding: 8px 16px;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    transition: background-color 0.3s ease;
  }

  .primary-button {
    background-color: var(--primary-color);
    color: white;
  }

  .secondary-button {
    background-color: var(--secondary-color);
    color: var(--text-color);
  }

  .primary-button:hover, .secondary-button:hover {
    opacity: 0.9;
  }

  #reportContent {
    margin-top: 20px;
    border: 1px solid var(--secondary-color);
    border-radius: 4px;
    padding: 20px;
    max-height: 500px;
    overflow-y: auto;
  }

  #reportContent table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: 20px;
  }

  #reportContent th, #reportContent td {
    border: 1px solid var(--secondary-color);
    padding: 8px;
    text-align: left;
  }

  #reportContent th {
    background-color: var(--secondary-color);
    font-weight: bold;
  }

  #reportContent h3, #reportContent h4 {
    margin-top: 20px;
    margin-bottom: 10px;
    color: var(--primary-color);
  }

  #reportContent table th:nth-child(5),
  #reportContent table td:nth-child(5) {
    max-width: 100px;
    overflow: hidden;
    text-overflow: ellipsis;
    white-space: nowrap;
  }

  @media (max-width: 768px) {
    #reportContent table th:nth-child(5),
    #reportContent table td:nth-child(5) {
      max-width: 60px;
    }
  }

  @media print {
    body {
      font-family: Arial, sans-serif;
      line-height: 1.6;
      color: #333;
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
    }
    h1, h2, h3, h4 {
      color: #3a6ea5;
      margin-top: 20px;
    }
    h1 {
      text-align: center;
      border-bottom: 2px solid #3a6ea5;
      padding-bottom: 10px;
    }
    table {
      border-collapse: collapse;
      width: 100%;
      margin-bottom: 20px;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: left;
    }
    th {
      background-color: #f2f2f2;
      font-weight: bold;
    }
    .restaurant-section {
      margin-bottom: 30px;
      page-break-inside: avoid;
    }
    .total-pax {
      font-weight: bold;
      text-align: right;
      margin-top: 10px;
    }
    .no-print {
      display: none;
    }
  }
</style>
</head>
<body>
  <div class="container">
    <h1>Reservas VIP'S Secrets</h1>
    <form id="reservationForm">
      <div class="form-group">
        <label for="date">Fecha:</label>
        <input type="date" id="date" required>
      </div>

      <div class="form-group">
        <label for="roomNumber">Número de Habitación:</label>
        <input type="text" id="roomNumber" required pattern="\d{1,4}" maxlength="4" inputmode="numeric">
      </div>

      <div class="form-group">
        <label for="guestName">Nombre del Huésped:</label>
        <input type="text" id="guestName" required>
      </div>

      <div class="form-group">
        <label for="restaurant">Restaurante:</label>
        <select id="restaurant" required>
          <option value="">Seleccione un restaurante</option>
          <option value="Bordeaux">Bordeaux</option>
          <option value="Himitsu">Himitsu</option>
          <option value="Hibachi">Hibachi</option>
          <option value="El Patio">El Patio</option>
          <option value="Bluewater">Bluewater</option>
          <option value="Olio">Olio</option>
        </select>
      </div>

      <div class="form-group">
        <label for="pax">Número de Personas:</label>
        <input type="number" id="pax" min="1" required>
      </div>

      <div class="form-group">
        <label for="time">Hora:</label>
        <select id="time" required>
          <option value="">Seleccione una hora</option>
        </select>
      </div>

      <div class="form-group">
        <label for="notes">Notas:</label>
        <textarea id="notes" rows="3" maxlength="30"></textarea>
        <small>Máximo 30 caracteres</small>
      </div>

      <button type="submit">Hacer Reserva</button>
    </form>

    <h2>Reservas Actuales</h2>
    <div id="reservationDisplay"></div>
  </div>

  <div class="corner-buttons">
    <button id="configButton" class="corner-button">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path></svg>
    </button>
    <button id="reportButton" class="corner-button">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>
    </button>
  </div>

  <div id="confirmationModal" class="modal">
    <div class="modal-content">
      <span class="close">&times;</span>
      <h2>Confirmación de Reserva</h2>
      <div id="reservationDetails"></div>
      <div id="dressCode" class="dress-code"></div>
    </div>
  </div>

  <div id="configModal" class="modal">
    <div class="modal-content">
      <h2>Configuración</h2>
      <div class="config-section">
        <h3>Límites de PAX por Restaurante</h3>
        <div id="restaurantLimits" class="grid-layout"></div>
      </div>
      <div class="config-section">
        <h3>Horarios de Restaurantes</h3>
        <div id="restaurantHours" class="grid-layout">
        </div>
      </div>
      <div class="config-section">
        <h3>Agregar Nuevo Restaurante</h3>
        <div class="grid-layout">
          <div>
            <label for="newRestaurantName">Nombre del Restaurante:</label>
            <input type="text" id="newRestaurantName">
          </div>
          <div>
            <label for="newRestaurantLimit">Límite de PAX:</label>
            <input type="number" id="newRestaurantLimit" min="1" value="8">
          </div>
          <div>
            <button onclick="addNewRestaurant()" class="primary-button">Agregar Restaurante</button>
          </div>
        </div>
      </div>
      <div class="config-section">
        <h3>Otras Configuraciones</h3>
        <div class="grid-layout">
          <div>
            <label for="defaultPaxLimit">Límite PAX predeterminado:</label>
            <input type="number" id="defaultPaxLimit" min="1" value="8">
          </div>
          <div>
            <label for="allowOverbooking">Permitir sobrerreservas:</label>
            <input type="checkbox" id="allowOverbooking">
          </div>
        </div>
      </div>
      <div class="config-section">
        <h3>Cierres de Restaurantes</h3>
        <div id="restaurantClosures" class="grid-layout">
        </div>
      </div>
      <div class="button-group">
        <button onclick="saveConfig()" class="primary-button">Guardar</button>
        <button onclick="closeModal('configModal')" class="secondary-button">Cerrar</button>
      </div>
    </div>
  </div>

  <div id="reportModal" class="modal">
    <div class="modal-content">
      <h2>Generar Reporte</h2>
      <div class="grid-layout">
        <div>
          <label for="reportStartDate">Fecha de inicio:</label>
          <input type="date" id="reportStartDate">
        </div>
        <div>
          <label for="reportEndDate">Fecha de fin:</label>
          <input type="date" id="reportEndDate">
        </div>
        <div>
          <label for="reportRestaurant">Restaurante (opcional):</label>
          <select id="reportRestaurant">
            <option value="">Todos los restaurantes</option>
            <option value="Bordeaux">Bordeaux</option>
            <option value="Himitsu">Himitsu</option>
            <option value="Hibachi">Hibachi</option>
            <option value="El Patio">El Patio</option>
            <option value="Bluewater">Bluewater</option>
            <option value="Olio">Olio</option>
          </select>
        </div>
      </div>
      <div class="button-group">
        <button onclick="generateReport()" class="primary-button">Generar</button>
        <button onclick="closeModal('reportModal')" class="secondary-button">Cerrar</button>
      </div>
    </div>
  </div>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyDUirwoSQgvcMZn7uLjKMAxlTA15Jkl2BM",
      authDomain: "ismakun-bf0fa.firebaseapp.com",
      databaseURL: "https://ismakun-bf0fa-default-rtdb.firebaseio.com",
      projectId: "ismakun-bf0fa",
      storageBucket: "ismakun-bf0fa.appspot.com",
      messagingSenderId: "1028877703945",
      appId: "1:1028877703945:web:331de48acbcdf2234a51d8"
    };

    firebase.initializeApp(firebaseConfig);
    const database = firebase.database();

    const restaurantSelect = document.getElementById('restaurant');
    const timeSelect = document.getElementById('time');

    const regularHours = ['6:00 PM', '7:30 PM', '8:30 PM', '9:00 PM'];
    const hibachiHours = ['6:00 PM', '7:15 PM', '8:30 PM', '9:45 PM'];

    let restaurantHours = {
      'Bordeaux': regularHours,
      'Himitsu': regularHours,
      'Hibachi': hibachiHours,
      'El Patio': regularHours,
      'Bluewater': regularHours,
      'Olio': regularHours
    };

    const dressCodes = {
      'Bluewater': 'Casual elegante – Zapatos tipo tenis o sandalias, camisas de vestir con manga corta o camisas tipo polo. No camisetas sin manga o sandalias de playa. Pantalón largo requerido para hombres o corto formal.',
      'Bordeaux': 'Formal - Hombres deben usar pantalones (no shorts, bermudas) camisas de vestir y zapatos de vestir. Mujeres deben usar blusas, faldas, pantalón de vestir o vestidos, con zapatos de vestir.',
      'El Patio': 'Casual elegante – Zapatos tipo tenis o sandalias, camisas de vestir con manga corta o camisas tipo polo. No camisetas sin manga o sandalias de playa. Pantalón largo requerido para hombres o corto formal.',
      'Himitsu': 'Casual elegante – Zapatos tipo tenis o sandalias, camisas de vestir con manga corta o camisas tipo polo. No camisetas sin manga o sandalias de playa. Pantalón largo requerido para hombres o corto formal.',
      'Hibachi': 'Casual elegante – Zapatos tipo tenis o sandalias, camisas de vestir con manga corta o camisas tipo polo. No camisetas sin manga o sandalias de playa. Pantalón largo requerido para hombres o corto formal.',
      'Olio': 'Casual - Bermudas, pantalones largos o pantalones capri, tennis o sandalias Hombres: no está permitido utilizar playeras sin mangas. Mujeres: no está permitida la entrada en traje de baño al restaurante.'
    };

    let reservations = {};
    let restaurantLimits = {
      'Bordeaux': 8,
      'Himitsu': 8,
      'Hibachi': 10,
      'El Patio': 8,
      'Bluewater': 8,
      'Olio': 8
    };

    let restaurantClosures = {};

    let config = {
      defaultPaxLimit: 8,
      allowOverbooking: false
    };

    function clearFormFields() {
      document.getElementById('date').value = '';
      document.getElementById('roomNumber').value = '';
      document.getElementById('guestName').value = '';
      document.getElementById('restaurant').value = '';
      document.getElementById('pax').value = '';
      document.getElementById('time').value = '';
      document.getElementById('notes').value = '';
    }

    function saveReservation(reservation) {
      const reservationRef = database.ref('reservations').push();
      reservationRef.set(reservation);
    }

    function loadReservations() {
      database.ref('reservations').on('value', (snapshot) => {
        const data = snapshot.val();
        reservations = {};
        for (let key in data) {
          const reservation = data[key];
          if (!reservations[reservation.date]) reservations[reservation.date] = {};
          if (!reservations[reservation.date][reservation.restaurant]) reservations[reservation.date][reservation.restaurant] = {};
          if (!reservations[reservation.date][reservation.restaurant][reservation.time]) reservations[reservation.date][reservation.restaurant][reservation.time] = [];
          reservations[reservation.date][reservation.restaurant][reservation.time].push(reservation);
        }
        updateReservationDisplay();
      });
    }

    function checkReservationAvailability(date, restaurant, time, pax) {
      if (!reservations[date]) reservations[date] = {};
      if (!reservations[date][restaurant]) reservations[date][restaurant] = {};
      if (!reservations[date][restaurant][time]) reservations[date][restaurant][time] = [];

      const currentPax = reservations[date][restaurant][time].reduce((sum, res) => sum + res.pax, 0);
      const limit = restaurantLimits[restaurant] || config.defaultPaxLimit;
      
      if (config.allowOverbooking) {
        return true;
      }
      
      return (currentPax + pax) <= limit;
    }

    function checkExistingReservation(date, roomNumber) {
      if (reservations[date]) {
        for (let restaurant in reservations[date]) {
          for (let time in reservations[date][restaurant]) {
            if (reservations[date][restaurant][time].some(res => res.roomNumber === roomNumber)) {
              return true;
            }
          }
        }
      }
      return false;
    }

    function showPopupMessage(message) {
      const modal = document.getElementById('confirmationModal');
      const detailsDiv = document.getElementById('reservationDetails');
      const dressCodeDiv = document.getElementById('dressCode');
      
      detailsDiv.innerHTML = `<p class="error-message">${message}</p>`;
      dressCodeDiv.innerHTML = '';

      modal.style.display = "block";
      setTimeout(() => modal.classList.add('show'), 10);
    }

    function updateReservationDisplay() {
      const display = document.getElementById('reservationDisplay');
      display.innerHTML = '';

      Object.keys(reservations).sort().forEach(date => {
        Object.keys(reservations[date]).forEach(restaurant => {
          const section = document.createElement('div');
          section.className = 'reservation-section';
          
          const header = document.createElement('h3');
          header.textContent = `${date} - ${restaurant}`;
          section.appendChild(header);

          const table = document.createElement('table');
          table.innerHTML = `
            <thead>
              <tr>
                <th>Hora</th>
                <th>Habitación</th>
                <th>Huésped</th>
                <th>PAX</th>
                <th>Notas</th>
              </tr>
            </thead>
            <tbody></tbody>
          `;

          const tbody = table.querySelector('tbody');
          let totalPax = 0;

          Object.keys(reservations[date][restaurant]).sort().forEach(time => {
            reservations[date][restaurant][time].forEach(res => {
              const row = tbody.insertRow();
              row.innerHTML = `
                <td data-label="Hora">${res.time}</td>
                <td data-label="Habitación">${res.roomNumber}</td>
                <td data-label="Huésped">${res.guestName}</td>
                <td data-label="PAX">${res.pax}</td>
                <td data-label="Notas">${res.notes || '-'}</td>
              `;
              row.addEventListener('click', () => showReservationDetails(res, false));
              row.style.cursor = 'pointer';
              totalPax += res.pax;
            });
          });

          section.appendChild(table);

          const totalElement = document.createElement('p');
          totalElement.className = 'total-pax';
          totalElement.textContent = `Total PAX: ${totalPax}`;
          section.appendChild(totalElement);

          display.appendChild(section);
        });
      });
    }

    function showConfirmation(reservation) {
      const modal = document.getElementById('confirmationModal');
      const detailsDiv = document.getElementById('reservationDetails');
      const dressCodeDiv = document.getElementById('dressCode');
      
      detailsDiv.innerHTML = `
        <h3>Reserva Confirmada</h3>
        <p><strong>Fecha:</strong> ${reservation.date}</p>
        <p><strong>Número de Habitación:</strong> ${reservation.roomNumber}</p>
        <p><strong>Nombre del Huésped:</strong> ${reservation.guestName}</p>
        <p><strong>Restaurante:</strong> ${reservation.restaurant}</p>
        <p><strong>Número de Personas:</strong> ${reservation.pax}</p>
        <p><strong>Hora:</strong> ${reservation.time}</p>
        <p><strong>Notas:</strong> ${reservation.notes || 'N/A'}</p>
      `;

      dressCodeDiv.innerHTML = `
        <h3>Código de Vestimenta</h3>
        <p>${dressCodes[reservation.restaurant]}</p>
      `;

      modal.style.display = "block";
      setTimeout(() => modal.classList.add('show'), 10);
    }

    function updateTimeOptions() {
      timeSelect.innerHTML = '<option value="">Seleccione una hora</option>';
      const restaurant = restaurantSelect.value;
      const hours = restaurantHours[restaurant] || regularHours;
      hours.forEach(hour => {
        const option = document.createElement('option');
        option.value = hour;
        option.textContent = hour;
        timeSelect.appendChild(option);
      });
    }

    restaurantSelect.addEventListener('change', updateTimeOptions);

    document.getElementById('reservationForm').addEventListener('submit', function(e) {
      e.preventDefault();
      
      const reservation = {
        date: document.getElementById('date').value,
        roomNumber: document.getElementById('roomNumber').value,
        guestName: document.getElementById('guestName').value,
        restaurant: document.getElementById('restaurant').value,
        pax: parseInt(document.getElementById('pax').value),
        time: document.getElementById('time').value,
        notes: document.getElementById('notes').value
      };

      if (isRestaurantClosed(reservation.date, reservation.restaurant)) {
        showPopupMessage(`Lo sentimos, ${reservation.restaurant} está cerrado en la fecha seleccionada.`);
        return;
      }

      if (checkExistingReservation(reservation.date, reservation.roomNumber)) {
        showPopupMessage("Ya existe una reserva para esta habitación en la fecha seleccionada.");
        return;
      }

      if (checkReservationAvailability(reservation.date, reservation.restaurant, reservation.time, reservation.pax)) {
        saveReservation(reservation);
        showConfirmation(reservation);
        clearFormFields();
      } else {
        showErrorMessage("Lo sentimos, no hay suficiente espacio disponible para esta reserva.");
      }
    });

    const formInputs = document.querySelectorAll('#reservationForm input, #reservationForm select');
    formInputs.forEach((input, index) => {
      input.addEventListener('keydown', function(e) {
        if (e.key === 'Enter') {
          e.preventDefault();
          const nextInput = formInputs[index + 1];
          if (nextInput) {
            nextInput.focus();
          } else {
            document.querySelector('#reservationForm button[type="submit"]').click();
          }
        }
      });
    });

    function showReservationDetails(reservation, isNewReservation = false) {
      const modal = document.getElementById('confirmationModal');
      const detailsDiv = document.getElementById('reservationDetails');
      const dressCodeDiv = document.getElementById('dressCode');
      
      detailsDiv.innerHTML = `
        ${isNewReservation ? '<h3>Reserva Confirmada</h3>' : ''}
        <p><strong>Fecha:</strong> ${reservation.date}</p>
        <p><strong>Número de Habitación:</strong> ${reservation.roomNumber}</p>
        <p><strong>Nombre del Huésped:</strong> ${reservation.guestName}</p>
        <p><strong>Restaurante:</strong> ${reservation.restaurant}</p>
        <p><strong>Número de Personas:</strong> ${reservation.pax}</p>
        <p><strong>Hora:</strong> ${reservation.time}</p>
        <p><strong>Notas:</strong> ${reservation.notes || 'N/A'}</p>
      `;

      dressCodeDiv.innerHTML = `
        <h3>Código de Vestimenta</h3>
        <p>${dressCodes[reservation.restaurant]}</p>
      `;

      modal.style.display = "block";
      setTimeout(() => modal.classList.add('show'), 10);
    }

    function showErrorMessage(message) {
      const modal = document.getElementById('confirmationModal');
      const detailsDiv = document.getElementById('reservationDetails');
      const dressCodeDiv = document.getElementById('dressCode');
      
      detailsDiv.innerHTML = `<p class="error-message">${message}</p>`;
      dressCodeDiv.innerHTML = '';

      modal.style.display = "block";
      setTimeout(() => modal.classList.add('show'), 10);
    }

    document.querySelector('.close').onclick = function() {
      const modal = document.getElementById('confirmationModal');
      modal.classList.remove('show');
      setTimeout(() => modal.style.display = "none", 300);
    }

    window.onclick = function(event) {
      const modal = document.getElementById('confirmationModal');
      if (event.target == modal) {
        modal.classList.remove('show');
        setTimeout(() => modal.style.display = "none", 300);
      }
    }

    const configButton = document.getElementById('configButton');
    const reportButton = document.getElementById('reportButton');

    configButton.addEventListener('click', () => {
      populateConfigModal();
      showModal('configModal');
    });

    reportButton.addEventListener('click', () => {
      showModal('reportModal');
    });

    function populateConfigModal() {
      const limitsContainer = document.getElementById('restaurantLimits');
      limitsContainer.innerHTML = '';
      Object.keys(restaurantLimits).forEach(restaurant => {
        limitsContainer.innerHTML += `
          <div>
            <label for="${restaurant}Limit">${restaurant}:</label>
            <input type="number" id="${restaurant}Limit" min="1" value="${restaurantLimits[restaurant]}">
          </div>
        `;
      });

      const hoursContainer = document.getElementById('restaurantHours');
      hoursContainer.innerHTML = '';
      Object.keys(restaurantHours).forEach(restaurant => {
        hoursContainer.innerHTML += `
          <div>
            <label for="${restaurant}Hours">${restaurant}:</label>
            <input type="text" id="${restaurant}Hours" value="${restaurantHours[restaurant].join(', ')}">
          </div>
        `;
      });

      document.getElementById('defaultPaxLimit').value = config.defaultPaxLimit;
      document.getElementById('allowOverbooking').checked = config.allowOverbooking;

      const closuresContainer = document.getElementById('restaurantClosures');
      closuresContainer.innerHTML = '';
      Object.keys(restaurantLimits).forEach(restaurant => {
        closuresContainer.innerHTML += `
          <div>
            <label for="${restaurant}Closure">${restaurant}:</label>
            <input type="date" id="${restaurant}Closure">
          </div>
        `;
      });

      Object.keys(restaurantClosures).forEach(date => {
        restaurantClosures[date].forEach(restaurant => {
          const input = document.getElementById(`${restaurant}Closure`);
          if (input) input.value = date;
        });
      });
    }

    function addNewRestaurant() {
      const name = document.getElementById('newRestaurantName').value;
      const limit = parseInt(document.getElementById('newRestaurantLimit').value);
      
      if (name && limit) {
        restaurantLimits[name] = limit;
        restaurantHours[name] = regularHours;
        
        const restaurantSelect = document.getElementById('restaurant');
        const option = document.createElement('option');
        option.value = name;
        option.textContent = name;
        restaurantSelect.appendChild(option);
        
        document.getElementById('newRestaurantName').value = '';
        document.getElementById('newRestaurantLimit').value = '8';
        
        populateConfigModal();
        
        alert(`Restaurante "${name}" agregado exitosamente.`);
      } else {
        alert('Por favor, ingrese un nombre y un límite válido para el nuevo restaurante.');
      }
    }

    function saveConfig() {
      const config = {
        restaurantLimits,
        restaurantHours,
        defaultPaxLimit: parseInt(document.getElementById('defaultPaxLimit').value),
        allowOverbooking: document.getElementById('allowOverbooking').checked,
        restaurantClosures
      };
      
      database.ref('config').set(config);
      
      updateTimeOptions();
      closeModal('configModal');
      alert('Configuración guardada');
    }

    function loadConfig() {
      database.ref('config').once('value').then((snapshot) => {
        const data = snapshot.val();
        if (data) {
          restaurantLimits = data.restaurantLimits || {};
          restaurantHours = data.restaurantHours || {};
          config.defaultPaxLimit = data.defaultPaxLimit || 8;
          config.allowOverbooking = data.allowOverbooking || false;
          restaurantClosures = data.restaurantClosures || {};
          
          updateTimeOptions();
          populateConfigModal();
        }
      });
    }

    function isRestaurantClosed(date, restaurant) {
      return restaurantClosures[date] && restaurantClosures[date].includes(restaurant);
    }

    function updateRestaurantOptions() {
      const dateInput = document.getElementById('date');
      const restaurantSelect = document.getElementById('restaurant');
      const selectedDate = dateInput.value;

      Array.from(restaurantSelect.options).forEach(option => {
        if (option.value) {
          option.disabled = isRestaurantClosed(selectedDate, option.value);
        }
      });
    }

    document.getElementById('date').addEventListener('change', updateRestaurantOptions);

    function showModal(modalId) {
      const modal = document.getElementById(modalId);
      modal.style.display = 'block';
      setTimeout(() => modal.classList.add('show'), 10);
    }

    function closeModal(modalId) {
      const modal = document.getElementById(modalId);
      modal.classList.remove('show');
      setTimeout(() => modal.style.display = 'none', 300);
    }

    function generatePrintReportHTML(reservations) {
      let reportHTML = '';
      
      Object.keys(reservations).sort().forEach(date => {
        reportHTML += `<h2>${date}</h2>`;
        Object.keys(reservations[date]).forEach(restaurant => {
          reportHTML += `
            <div class="restaurant-section">
              <h3>${restaurant}</h3>
              <table>
                <thead>
                  <tr>
                    <th>Hora</th>
                    <th>Habitación</th>
                    <th>Huésped</th>
                    <th>PAX</th>
                    <th>Notas</th>
                  </tr>
                </thead>
                <tbody>
          `;
          let totalPax = 0;
          Object.keys(reservations[date][restaurant]).sort().forEach(time => {
            reservations[date][restaurant][time].forEach(res => {
              reportHTML += `
                <tr>
                  <td>${res.time}</td>
                  <td>${res.roomNumber}</td>
                  <td>${res.guestName}</td>
                  <td>${res.pax}</td>
                  <td>${res.notes || '-'}</td>
                </tr>
              `;
              totalPax += res.pax;
            });
          });
          reportHTML += `
                </tbody>
              </table>
              <p class="total-pax">Total PAX: ${totalPax}</p>
            </div>
          `;
        });
      });
      
      return reportHTML;
    }

    function generateReport() {
      const startDate = document.getElementById('reportStartDate').value;
      const endDate = document.getElementById('reportEndDate').value;
      const selectedRestaurant = document.getElementById('reportRestaurant').value;
      
      if (!startDate || !endDate) {
        alert('Por favor, seleccione fechas de inicio y fin.');
        return;
      }

      let filteredReservations = Object.keys(reservations)
        .filter(date => date >= startDate && date <= endDate)
        .reduce((obj, key) => {
          obj[key] = reservations[key];
          return obj;
        }, {});

      if (selectedRestaurant) {
        filteredReservations = Object.keys(filteredReservations).reduce((obj, date) => {
          if (filteredReservations[date][selectedRestaurant]) {
            obj[date] = { [selectedRestaurant]: filteredReservations[date][selectedRestaurant] };
          }
          return obj;
        }, {});
      }

      let reportHTML = `<h1>Reporte de Reservas</h1>
        <p><strong>Período:</strong> ${startDate} - ${endDate}</p>
        ${selectedRestaurant ? `<p><strong>Restaurante:</strong> ${selectedRestaurant}</p>` : ''}
        ${generatePrintReportHTML(filteredReservations)}`;

      const printButton = document.createElement('button');
      printButton.textContent = 'Imprimir Reporte';
      printButton.className = 'primary-button';
      printButton.onclick = () => {
        const printWindow = window.open('', '_blank');
        printWindow.document.write(`
          <html>
            <head>
              <title>Reporte de Reservas</title>
              <style>
                body {
                  font-family: Arial, sans-serif;
                  line-height: 1.6;
                  color: #333;
                  max-width: 800px;
                  margin: 0 auto;
                  padding: 20px;
                }
                h1, h2, h3, h4 {
                  color: #3a6ea5;
                  margin-top: 20px;
                }
                h1 {
                  text-align: center;
                  border-bottom: 2px solid #3a6ea5;
                  padding-bottom: 10px;
                }
                table {
                  border-collapse: collapse;
                  width: 100%;
                  margin-bottom: 20px;
                }
                th, td {
                  border: 1px solid #ddd;
                  padding: 8px;
                  text-align: left;
                }
                th {
                  background-color: #f2f2f2;
                  font-weight: bold;
                }
                .restaurant-section {
                  margin-bottom: 30px;
                  page-break-inside: avoid;
                }
                .total-pax {
                  font-weight: bold;
                  text-align: right;
                  margin-top: 10px;
                }
                @media print {
                  body {
                    font-size: 11pt;
                  }
                }
              </style>
            </head>
            <body>
              ${reportHTML}
            </body>
          </html>
        `);
        printWindow.document.close();
        printWindow.print();
      };

      const reportModal = document.getElementById('reportModal');
      reportModal.querySelector('.modal-content').appendChild(printButton);
      reportModal.querySelector('#reportContent').innerHTML = reportHTML;
      showModal('reportModal');
    }

    updateTimeOptions();
    loadReservations();
    loadConfig();
    
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
      anchor.addEventListener('click', function (e) {
        e.preventDefault();
        document.querySelector(this.getAttribute('href')).scrollIntoView({
          behavior: 'smooth'
        });
      });
    });

    const inputs = document.querySelectorAll('input, select, textarea');
    inputs.forEach(input => {
      input.addEventListener('focus', () => {
        input.parentElement.classList.add('focus');
      });
      input.addEventListener('blur', () => {
        input.parentElement.classList.remove('focus');
      });
    });

    document.getElementById('roomNumber').addEventListener('input', function(e) {
      this.value = this.value.replace(/\D/g, '').slice(0, 4);
    });

    updateTimeOptions();
    updateRestaurantOptions();
  </script>
</body></html>
